{{if eq (len .Trackers) 0}}
<div class="empty-state">
    <h2>No trackers found</h2>
    <p>Try a different filter, or add your first source entry.</p>
</div>
{{else}}
{{if eq .ViewMode "list"}}
<div class="cards-list">
    {{range .Trackers}}
    <article class="tracker-row tracker-card">
        <div class="tracker-row__title-wrap">
            <h3>{{.Title}}</h3>
        </div>

        <div class="tracker-row__status">
            <span class="badge badge--status" title="{{.StatusLabel}}">{{.StatusLabel}}</span>
        </div>

        <div class="tracker-row__metric">
            <span class="tracker-row__chapter">{{.LastReadChapter}}</span>
            <span class="tracker-row__time">Read {{.LastReadAgo}}</span>
        </div>

        <div class="tracker-row__metric">
            <span class="tracker-row__chapter tracker-row__chapter--accent">{{.LatestKnownChapter}}</span>
            <span class="tracker-row__time">Released {{.LatestReleaseAgo}}</span>
        </div>

        <div class="tracker-row__actions">
            <button type="button"
                    class="mini-btn"
                    hx-post="/dashboard/trackers/{{.ID}}/set-last-read"
                    hx-target="#modal-zone"
                    hx-swap="innerHTML">Set last read</button>
            <a class="mini-btn mini-btn--highlight"
               href="{{.SourceURL}}"
               target="_blank"
               rel="noopener noreferrer">Open</a>
            <button type="button"
                    class="mini-btn"
                    hx-get="/dashboard/trackers/{{.ID}}/edit"
                    hx-target="#modal-zone"
                    hx-swap="innerHTML">Edit</button>
            <button type="button"
                    class="mini-btn mini-btn--danger"
                    hx-post="/dashboard/trackers/{{.ID}}/delete"
                    hx-target="#modal-zone"
                    hx-swap="innerHTML"
                    hx-confirm="Delete this tracker?">Delete</button>
        </div>
    </article>
    {{end}}
</div>
{{else}}
<div class="cards-grid">
    {{range .Trackers}}
    <article class="tracker-card">
        <header class="tracker-card__header">
            <h3>{{.Title}}</h3>
            <span class="badge" title="{{.StatusLabel}}">{{.StatusLabel}}</span>
        </header>

        <div class="tracker-card__cover">
            {{if .CoverURL}}
            <img src="{{.CoverURL}}" alt="{{.Title}} cover" loading="lazy" referrerpolicy="no-referrer">
            {{else}}
            <div class="tracker-card__cover-title">{{.Title}}</div>
            {{end}}
        </div>

        <div class="tracker-card__stats">
            <div class="stat-row">
                <span class="stat-label">Latest Known Chapter:</span>
                <span class="stat-value">{{.LatestKnownChapter}}</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Release Date:</span>
                <span class="stat-value">{{.LatestReleaseAgo}}</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Last Read Chapter:</span>
                <span class="stat-value">{{.LastReadChapter}}</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Read Date:</span>
                <span class="stat-value">{{.LastReadAgo}}</span>
            </div>
        </div>

        <div class="card-actions">
            <button type="button"
                    class="mini-btn"
                    hx-post="/dashboard/trackers/{{.ID}}/set-last-read"
                    hx-target="#modal-zone"
                    hx-swap="innerHTML">Set last read</button>
            <a class="mini-btn mini-btn--highlight"
               href="{{.SourceURL}}"
               target="_blank"
               rel="noopener noreferrer">Highlight</a>
        </div>

        <div class="card-actions card-actions--secondary">
            <button type="button"
                    class="mini-btn"
                    hx-get="/dashboard/trackers/{{.ID}}/edit"
                    hx-target="#modal-zone"
                    hx-swap="innerHTML">Edit</button>
            <button type="button"
                    class="mini-btn mini-btn--danger"
                    hx-post="/dashboard/trackers/{{.ID}}/delete"
                    hx-target="#modal-zone"
                    hx-swap="innerHTML"
                    hx-confirm="Delete this tracker?">Delete</button>
        </div>
    </article>
    {{end}}
</div>
{{end}}
{{end}}
