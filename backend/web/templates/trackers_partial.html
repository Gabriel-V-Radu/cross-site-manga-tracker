{{if eq (len .Trackers) 0}}
<div class="empty-state">
    <h2>No trackers found</h2>
    <p>Try a different filter, or add your first source entry.</p>
</div>
{{else}}
{{if eq .ViewMode "list"}}
<div id="cards-container-list" class="cards-list">
    {{range .Trackers}}
    {{template "tracker_card_list" .}}
    {{end}}
</div>
{{else}}
<div id="cards-container-grid" class="cards-grid">
    {{range .Trackers}}
    {{template "tracker_card_grid" .}}
    {{end}}
</div>
{{end}}

<div class="panel-actions" style="margin-top:16px; justify-content:flex-end;">
    {{if .HasPrevPage}}
    <button type="button"
            class="action-btn js-page-btn"
            data-page-target="{{.Page}}"
            data-page-delta="-1">
        Previous
    </button>
    {{end}}
    {{if .HasNextPage}}
    <button type="button"
            class="action-btn action-btn--accent js-page-btn"
            data-page-target="{{.Page}}"
            data-page-delta="1">
        Next
    </button>
    {{end}}
</div>
{{end}}

{{if .PendingCovers}}
<script>
    (function () {
        var refreshKey = "{{.RefreshKey}}";
        if (!refreshKey || !document || !document.body) {
            return;
        }

        if (!window.__coverRefreshAttempts) {
            window.__coverRefreshAttempts = {};
        }

        var attempts = Number(window.__coverRefreshAttempts[refreshKey] || 0);
        if (attempts >= 3) {
            return;
        }

        window.__coverRefreshAttempts[refreshKey] = attempts + 1;
        window.setTimeout(function () {
            window.__silentCoverRefresh = true;
            document.body.dispatchEvent(new Event('trackersChanged'));
        }, 900);
    })();
</script>
{{else}}
<script>
    (function () {
        var refreshKey = "{{.RefreshKey}}";
        if (!refreshKey || !window.__coverRefreshAttempts) {
            return;
        }
        delete window.__coverRefreshAttempts[refreshKey];
    })();
</script>
{{end}}
